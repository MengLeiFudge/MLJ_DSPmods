UIReplicatorWindow

【商店列表——物品】
老虎机分馏塔，仅能兑换一次

【老虎机分馏塔】
解锁时机：初始，开局给予1个
合成配方：无法使用配方合成，升降级分馏塔处理任意分馏塔时，有极小概率分出该分馏塔。
机制：与垃圾回收分馏塔类似，可以接受任意物品。
正面输出时，分馏塔处于“自选模式”，可将物品转换为选定物品；
否则分馏塔处于处于“解锁模式”，解锁对应的普通配方；输入矩阵，可以增加持有的货币，用于抽卡。

【配方】
配方页面可以看到当前所有的配方的星级、概率等信息。配方分1-5星（所有都可升至5星），白绿蓝紫金五个品质（不可提升）。
星级影响配方强度，星级越高则转换效率越高。品质表示配方稀有度，越高稀有则越难升星（因为难以获取），实际对配方效率没有影响。

【自选】
自选配方页面可以任选一种你想要的物品。选定目标产物后，向老虎机分馏塔输入任意物品，分馏塔正面将会输出选定的物品。
老虎机分馏塔会获取输入物品的总价值，然后乘一个小于1的系数，按照计算后的价值与目标产物的单价，转换为目标产物。
你可以在商店购买自选配方效率提升，它可以增大上面提到的“小于1的系数”。每解锁一层新的商店，就可以多购买一次。
自选配方的切换次数有限制。每次解锁更高级的商店时，可以购买一次切换次数。除此之外，抽卡也有概率增加自选次数。

【商店】
商店页面按照糖的类型，分为六层商店（蓝糖商店-白糖商店）。可以查看当前已输入的矩阵数目，以及可购买的内容。
首先需要解锁商店。你需要向老虎机分馏塔输入一定量的对应矩阵（别忘了正面不能输出！），以解锁对应商店。商店不可跨层解锁，即只有解锁红糖商店后，才能解锁黄糖商店，以此类推。
商店内有很多物品，大致包含以下内容：
1.部分分馏配方（下文将以“普通配方”指代）。
普通配方包含一些对游戏体验影响较小的配方，例如自然资源复制，以及建筑、运输机、武器分馏等。
普通配方
每层商店都只能解锁对应科技层次的分馏配方。例如，火电科技最高需要蓝糖，则风电-火电分馏配方在蓝糖商店内。
如果想解锁普通配方，你需要向老虎机分馏塔输入一定量的对应物品（别忘了正面不能输出！）。你可以在商店页面浏览有哪些配方可以解锁，并查看解锁进度。
每个配方的解锁进度都有最大值，它表示你最多需要多少个对应物品才能解锁该配方。解锁配方需要的物品数目依据价值而定，价值越高，解锁上限越少。
解锁进度预计呈正态分布。假设上限为1000，则大概率在输入500个物品的时候解锁，至多需要1000个物品解锁。解锁后，可以得到对应的1星配方。
如果想升星普通配方，可以继续输入一定量的对应物品，也可以使用大量碎片（抽卡副产物，下面有介绍）。配方至多提升至5星。
2.自选配方效率提升。功能上面已经说过，每解锁一层新的商店，就可以多购买一次。白糖后无限购买，但加成越来越低。
3.自选更新次数提升。功能上面已经说过，每解锁一层新的商店，就可以多购买一次。白糖后无限购买，需要的白糖会变多，达到上限（暂定1000糖）后不再增加。

【抽卡】
抽卡包括配方抽奖、特殊抽奖。分单抽、十连抽，使用矩阵作为货币。
同样的，向老虎机分馏塔输入一定量的矩阵，以将其转换为对应的货币（别忘了正面不能输出！）。
不同颜色的糖对应不同的货币，互不影响。已经转为货币的糖无法以任何方式取出（应该也没人要取出吧？）。
1.配方抽奖，可以获取部分特殊的分馏配方（下文将以“高级配方结晶”指代），以及碎片（名字未定，暂时用碎片代替，可以当狗粮，换东西等等）。
高级配方包含一些可以快速跳过游戏进程的配方，例如红绿蓝马达分馏、矩阵分馏等。
抽卡时，消耗指定的矩阵作为货币，可以获取高级配方结晶或碎片。
第一次抽到某个高级配方结晶后，它会自动消耗并解锁对应的1星配方。之后的高级配方结晶不会自动消耗。
你只能获取现在已经研究过的科技相关的配方。例如，如果目前解锁了绿马达但是并未解锁蓝马达，则无法抽到绿-蓝马达的配方。你可以在抽卡页面查看所有当前可获取的配方。
如果想升星高级配方，需要使用一定量的同名配方结晶，还有大量碎片。配方至多提升至5星。升至5星后，再抽到的同名配方将按照配方价值转为一定量精华，精华可用于兑换任意配方结晶。
抽卡具有保底机制。1至62抽时，每次抽卡的概率为0.7%。从63抽开始，每抽的概率提升7%，直到第74抽时达到81.2%。从75抽开始，每抽的概率提升3.5%，直到第80抽时达到100%。
抽卡具有喜好机制。你可以选择一个你最想要的配方，两个次级想要的配方。每个矩阵对应的卡池都可以选择一次，这三个槽位均无法选择矩阵。
出金时有37.5%的概率出最想要的配方，37.5%的概率出次想要配方。如果连续两次出金都不是最想要的配方，第三次出金必定是最想要的配方。
2.特殊抽奖，可以获取一些极其特殊的物品或加成。
可能出现的有：未定



在角色池中，1至73抽时，每次抽卡的概率为0.6%。从74抽开始，每抽的概率逐渐递增约6%，直到90抽时达到100%。具体来说，出金时有50%的概率会出当期up角色，50%的概率出常驻角色。出金概率在74至90抽之间逐步提升，平均up角色的期望抽数为93.36抽。



【分馏链增强】
分馏仍然是单链，但是形式上变化多样。
当一个物品被分馏时（对应一个FracRecipe），有如下几种可能：
1.无变化（显然这个不需要设定概率，其他几项都没触发就是这个）
2.变为主要产物（唯一，概率最高可加至5%，不可降低）
3.变为次要产物（概率最高可加至5%，不可降低）
4.损毁（除非自我复制，否则必有）

【增产剂对分馏配方的影响】
对大部分分馏塔，增产剂只有加速效果，也就是分馏出物品的概率增加，（损毁概率减少）。
概率影响的是建筑占地，损毁影响的是转换比例。

【各个分馏塔的改动趋向】
【自然资源分馏】
1.部分配方有概率输出其他物品
2.调整部分珍奇复制概率（按照稀有度调整）
可燃冰（巨星） > 分型硅 / 金伯利 / 有机其次（分布散） > 刺笋 / 光栅（有星球大量存在） > 磁石（仅黑洞中子星）
3.当流动原料少于一定数目，大幅提升分馏成功率，以适配极低概率矿物
【升级分馏】
1.如果分馏链有更高级物品，有小概率输出更高级的物品
【降级分馏】
1.极高损毁率，最终产物在50%以下，主要用于消灭升级分馏产生的中间产物

当某个星球分馏塔到达一定数目，所有分馏塔的耗电均上升；可用加成削减此debuff
根据已经分馏的物品数目（单个分馏塔的统计），给予分馏塔一定加成

【分馏塔的输入、输出调整】
现在，所有分馏塔都能接受任意物品（原版分馏塔除外），不再有无法输入的情况。
配方主输出会显示到分馏塔详情窗口，其他输出暂时无法在面板看到，但仍然存储在moddsv中。
分馏塔升降级时，物品会加入玩家背包，以确保正常运行。

【配方解锁】
1.直接随目标产物对应科技解锁
2.先解锁目标产物对应科技，再输入指定量的目标产物
3.先解锁目标产物对应科技，再从对应奖池使用特殊货币抽奖
4.无视科技要求，直接从对应奖池/特殊奖池抽奖

【配方类型】
分馏配方可分为复制、升级、降级这三种。
对于材料而言，分馏配方设置为无杂质（应该不会有人需要有杂质的吧？）
对于建筑而言，分馏配方设置为有杂质（也就意味着可能出现更高级别的物品）
前几个配方可以选择有杂质或无杂质版本，以减少SL。后面的配方可能为有杂质版本，也可能为无杂质版本。

【配方升级/强化/加点/突破-】
每个配方均有等级，初始为1。升级与解锁类似，但条件可能不同。
随着升级，将会获取“点数”，点数可以修改配方在某个属性上的情况。
所有配方共享点数，或每个配方有单独的点数。
点数可以重置，但是需要消耗一定量货币。重置机制对数据结构的设计还是有一定影响的，可能不太好处理。
升级如果需要材料，可能需要考虑是否值得花费这么多时间；如果共享点数，需要考虑如何分配，何时重置。
升级要么主动选择升级方向，要么全面提升。

所有对配方的改变可以视为相同类型，但显然有些是变化较大的，有些是变化较小的。
是否考虑增加突破机制，以回退配方级别为代价，给配方增加强力的特殊属性？（例如可以跨等级产出高等级）









【待办】

如果有手段强化某个配方，你希望是哪种方式：
1.配方消耗一定物品升级，每一级有固定的对应加成，例如1-2是主产物概率+1%，2-3是损毁-0.5%
2.配方消耗一定物品升级，每级提供一个点数，可以选择强化的方向，例如1-2的点数既可以加在主产物概率提升，也可以加在损毁上
3.混合着来，某些特殊等级提供自由点数，其他等级均为固定对应加成

分馏执行的过程可以提供经验（？） 以用于配方强化

3.升级配方消耗沙土
商店用到的货币：
1.各种矩阵（用于抽取特定奖池，以及某些配方的突破）
2.各种材料（仅用于解锁）
3.抽卡获得的材料（狗粮，也是大部分配方升级需要的材料）
4.特殊货币（用于抽卡或购买一些特殊加成）
5.沙土（升级需要）

//自然资源复制
//采集10个对应物品，或者向老虎机投入10个对应物品，即可解锁自然资源复制配方
//使用自然资源分馏塔成功分馏出指定数目的物品之后，配方可以消耗资源来升级

       int gridIndex = outputItem.recipes.Count == 0
                    ? 0
                    : outputItem.recipes[0].GridIndex + (tab分馏1 - 1) * 1000;
                //前置科技如果为null，【必须】修改为戴森球计划，才能确保某些配方能正常解锁、显示
                TechProto preTech = outputItem.preTech;
                preTech ??= LDB.techs.Select(T戴森球计划);

4.增加分馏效果预览，可以看到最终效果  2.7%xxx 2.7%xxx 2.7%损毁

5.增加超限等级，可以突破原有的限制


【UI】
原料：a
建筑：自然资源（复制，变多）/ 升级（降级）
目标产物：
2%分馏出1个b      【增加0.5%】【降低0.5%】
1%分馏出1个c      【增加0.5%】【降低0.5%】
0.5%分馏出1个d    【增加0.5%】【降低0.5%】
2%原料损毁        【降低一半】


分馏统计UI增加损毁统计
