<?xml version="1.0" encoding="utf-8"?>

<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <TargetFramework>net472</TargetFramework>
        <BepInExPluginGuid>com.menglei.dsp.fe</BepInExPluginGuid>
        <Description>DSP MOD - FractionateEverything</Description>
        <Version>2.2.0</Version>
        <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
        <LangVersion>latest</LangVersion>
        <PackageId>FractionateEverything</PackageId>
        <RootNamespace>FE</RootNamespace>
        <RestoreAdditionalProjectSources>https://nuget.bepinex.dev/v3/index.json</RestoreAdditionalProjectSources>
        <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    </PropertyGroup>
    <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
      <DebugType>full</DebugType>
    </PropertyGroup>
    <ItemGroup>
        <PackageReference Include="BepInEx.Core" Version="5.4.17"/>
        <PackageReference Include="BepInEx.PluginInfoProps" Version="1.0.0"/>
        <PackageReference Include="UnityEngine.Modules" Version="2018.4.12" IncludeAssets="compile"/>
        <PackageReference Include="DysonSphereProgram.Modding.CommonAPI" Version="1.6.5"/>
        <PackageReference Include="DysonSphereProgram.Modding.DSPModSave" Version="1.2.0"/>
        <PackageReference Include="DysonSphereProgram.Modding.LDBTool" Version="3.0.0"/>
        <PackageReference Include="DysonSphereProgram.GameLibs" Version="0.10.32.25779-r.0"/>
        <!-- 本地 Assembly-CSharp-publicized.dll 手动覆盖 GameLibs 的对应 dll 即可 -->
        <Reference Include="BuildBarTool">
            <HintPath>..\lib\BuildBarTool.dll</HintPath>
        </Reference>
        <Reference Include="DSP_Battle">
            <HintPath>..\lib\DSP_Battle-publicized.dll</HintPath>
        </Reference>
        <Reference Include="ProjectGenesis">
            <HintPath>..\lib\ProjectGenesis-publicized.dll</HintPath>
        </Reference>
    </ItemGroup>
    <ItemGroup Condition="'$(TargetFramework.TrimEnd(`0123456789`))' == 'net'">
        <PackageReference Include="Microsoft.NETFramework.ReferenceAssemblies" Version="1.0.3" PrivateAssets="all"/>
    </ItemGroup>
    <Target Name="PostBuild" AfterTargets="PostBuildEvent" Condition="'$(Configuration)' == 'Release'">
        <Exec Command="del /F /Q package\$(ProjectName)-$(Version).zip&#xA;powershell Compress-Archive -Force -DestinationPath 'package/$(ProjectName)-$(Version).zip' -Path &quot;$(TargetPath)&quot;, package/icon.png, package/manifest.json, README.md, CHANGELOG.md"/>
    </Target>
</Project>